<!DOCTYPE html>
<html lang="zh-CN" data-theme="light" data-font="sans-serif">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>说几句</title>
    <!-- 加载基础字体和新的花体英文 'Sacramento' -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@400;700&family=Noto+Serif+SC:wght@400;700&family=Sacramento&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body data-lang="zh-CN">
    
    <!-- 主容器 -->
    <div class="container" id="app-container">
        <!-- 顶部导航 -->
        <header>
            <h1>说几句</h1>
            <div class="header-controls">
                <div class="search-area">
                    <input type="text" id="search-input" placeholder="搜索日记内容...">
                    <button id="clear-search-btn" aria-label="清除搜索" class="hidden">&times;</button>
                </div>
            </div>
            <div class="header-actions">
                <button id="toggle-3d-view-btn" class="header-icon-btn" title="切换3D日记本模式">
                    <svg viewBox="0 0 24 24" width="24" height="24"><path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"/></svg>
                </button>
                <button id="profile-btn" class="header-icon-btn" aria-label="我的主页">
                    <span id="header-avatar-display" class="avatar"></span>
                </button>
                <button id="settings-btn" class="header-icon-btn" aria-label="应用设置">
                    <svg viewBox="0 0 24 24"><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61-.25-1.17-.59-1.69-.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19-.15-.24-.42-.12-.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23-.09-.49 0 .61-.22l2-3.46c.12-.22-.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"/></svg>
                </button>
                <button id="open-entry-form-btn" class="action-btn">写新日记</button>
            </div>
        </header>

        <!-- 视图容器 -->
        <main id="diary-thread"></main>
        <main id="diary-book-3d" class="hidden">
            <div class="book-container">
                <div class="book">
                    <div class="book-cover">
                        <div class="cover-front">
                            <div class="cover-decoration">
                                <div class="cover-title">我的日记本</div>
                                <div class="cover-subtitle">记录生活的点滴</div>
                                <div class="cover-icon">
                                    <svg viewBox="0 0 24 24" width="60" height="60"><path d="M18 2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zM6 4h5v8l-2.5-1.5L6 12V4z"/></svg>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="book-pages">
                        <div class="pages-container"></div>
                        <div id="book-controls-overlay" class="book-controls-overlay">
                            <button id="prev-page-btn" class="page-nav-btn"><svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg></button>
                            <div class="page-indicator"><span id="current-page">封面</span></div>
                            <button id="next-page-btn" class="page-nav-btn"><svg viewBox="0 0 24 24"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg></button>
                        </div>
                    </div>
                </div>
                <button id="close-book-btn" class="close-book-btn"><svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>返回列表</button>
            </div>
        </main>
    </div>

    <!-- 模态框区域 -->
    <div id="modal-overlay-container">
        <div id="welcome-modal" class="modal-overlay">
            <div class="modal-content welcome-modal-content">
                <h2>欢迎来到说几句！</h2>
                <p>这是一个记录您想法和心情的地方。您可以方便地撰写、整理您的日记，并自定义应用的外观。</p>
                <div class="modal-actions">
                    <button id="close-welcome-btn" class="btn-primary">好的，知道了</button>
                </div>
            </div>
        </div>
        
        <div id="entry-form-modal" class="modal-overlay">
            <div class="modal-content">
                <h2 id="entry-form-title">记录此刻的想法...</h2>
                <div class="entry-main-input-area">
                    <textarea id="diary-textarea" placeholder="今天发生了什么有意思的事吗？"></textarea>
                    <div class="entry-toolbar">
                        <button id="toggle-tags-input-btn" class="toolbar-icon-btn" title="添加/编辑标签"><svg viewBox="0 0 24 24"><path d="M21.41 11.58l-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42zM5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7z"/></svg></button>
                    </div>
                </div>
                <div id="tags-input-container" class="tags-input-container hidden">
                    <label for="entry-tags-input" class="visually-hidden">标签</label>
                    <input type="text" id="entry-tags-input" placeholder="标签 (多个请用逗号 ', ' 分隔)">
                </div>
                <input type="hidden" id="editing-entry-id">
                <div class="modal-actions">
                    <button id="close-entry-form-btn" class="btn-secondary">取消</button>
                    <button id="save-entry-btn" class="btn-primary">发布</button>
                </div>
            </div>
        </div>

        <div id="confirmation-modal" class="modal-overlay">
            <div class="modal-content">
                <h2>确认删除</h2>
                <p>你确定要删除这篇日记吗？此操作无法撤销。</p>
                <div class="modal-actions">
                    <button id="cancel-delete-btn" class="btn-secondary">取消</button>
                    <button id="confirm-delete-btn" class="btn-danger">删除</button>
                </div>
            </div>
        </div>

        <div id="profile-modal" class="modal-overlay">
            <div class="modal-content">
                <div class="profile-header">
                    <div id="profile-display-avatar" class="profile-avatar"></div>
                    <h2 id="profile-display-name" class="profile-name">匿名用户</h2>
                    <p id="profile-display-signature" class="signature">这个人很神秘，什么也没说。</p>
                </div>
                <div class="profile-stats">
                  <div class="profile-stats-container">
                    <div class="profile-stats-item">
                      <div class="profile-stats-value" id="total-entries">0</div><div class="profile-stats-label">总日记数</div>
                    </div>
                    <div class="profile-stats-item">
                      <div class="profile-stats-value" id="total-words">0</div><div class="profile-stats-label">总字数</div>
                    </div>
                    <div class="profile-stats-item">
                      <div class="profile-stats-value" id="latest-entry">-</div><div class="profile-stats-label">最近更新</div>
                    </div>
                  </div>
                </div>
                <div class="modal-actions">
                    <button id="edit-profile-btn" class="btn-secondary">编辑个人资料</button>
                    <button id="close-profile-btn" class="btn-primary">关闭</button>
                </div>
            </div>
        </div>

        <div id="edit-profile-modal" class="modal-overlay">
            <div class="modal-content">
                <h2>编辑个人资料</h2>
                <div class="settings-section">
                    <div class="form-group">
                        <label for="profile-avatar-file-input">头像</label>
                        <input type="file" id="profile-avatar-file-input" class="visually-hidden" accept="image/*">
                        <div class="avatar-preview-container">
                            <div id="profile-avatar-upload-trigger" class="avatar-preview" title="点击更换头像"><div id="profile-avatar-preview-area"></div></div>
                            <p class="section-desc" style="margin: 0;">点击左侧预览区域更换图片。</p>
                        </div>
                    </div>
                    <div class="form-group"><label for="profile-username-input">昵称</label><input type="text" id="profile-username-input" placeholder="你的昵称"></div>
                    <div class="form-group"><label for="profile-signature-input">个性签名</label><textarea id="profile-signature-input" rows="2" placeholder="说说你的座右铭"></textarea></div>
                </div>
                <div class="modal-actions">
                    <button id="cancel-edit-profile-btn" class="btn-secondary">取消</button>
                    <button id="save-profile-btn" class="btn-primary">保存</button>
                </div>
            </div>
        </div>

        <div id="settings-modal" class="modal-overlay">
            <div class="modal-content settings-modal-content">
                <h2 id="settings-modal-title">应用设置</h2>
                <div class="settings-main-area">
                    <div class="settings-nav">
                        <ul id="settings-nav-list">
                            <li data-target="panel-appearance" class="active">主题外观</li><li data-target="panel-font">字体设置</li><li data-target="panel-display">显示偏好</li><li data-target="panel-data">数据管理</li>
                        </ul>
                    </div>
                    <div class="settings-content-area">
                        <div id="panel-appearance" class="settings-panel active">
                            <h3>主题色彩</h3>
                            <div class="settings-section"><p class="section-desc">选择预设主题</p><div class="theme-grid"><div class="theme-option" data-theme="light"><div class="theme-preview theme-preview-light"></div><span>明亮</span></div><div class="theme-option" data-theme="dark"><div class="theme-preview theme-preview-dark"></div><span>暗黑</span></div><div class="theme-option" data-theme="dusk"><div class="theme-preview theme-preview-dusk"></div><span>薄暮</span></div><div class="theme-option" data-theme="morandi-pink"><div class="theme-preview theme-preview-morandi-pink"></div><span>莫兰迪粉</span></div><div class="theme-option" data-theme="morandi-blue"><div class="theme-preview theme-preview-morandi-blue"></div><span>莫兰迪蓝</span></div><div class="theme-option" data-theme="morandi-green"><div class="theme-preview theme-preview-morandi-green"></div><span>莫兰迪绿</span></div><div class="theme-option" data-theme="morandi-grey"><div class="theme-preview theme-preview-morandi-grey"></div><span>莫兰迪灰</span></div></div></div>
                        </div>
                        <div id="panel-font" class="settings-panel">
                            <h3>全局字体</h3>
                            <div class="settings-section">
                                <p class="section-desc">选择应用界面的主要字体</p>
                                <div class="font-options" id="font-options-container">
                                    <!-- JS 动态填充全局字体 -->
                                </div>
                            </div>
                            <div class="settings-section">
                                <h3>3D日记本字体</h3>
                                <p class="section-desc">为3D阅读模式单独设置字体</p>
                                <div class="form-group">
                                    <label for="book-font-zh-url-input">中文字体 CSS 链接</label>
                                    <input type="url" id="book-font-zh-url-input" placeholder="https://...">
                                </div>
                                <div class="form-group">
                                    <label for="book-font-en-url-input">英文字体 CSS 链接</label>
                                    <input type="url" id="book-font-en-url-input" placeholder="https://...">
                                </div>
                            </div>
                            <div class="settings-section" id="custom-font-section">
                                <h3>添加新字体到您的字体库</h3>
                                <p class="section-desc">添加后，您可以在“全局字体”中选择使用它。</p>
                                <div class="add-font-form">
                                    <input type="text" id="custom-font-name-input" placeholder="字体别名 (如：阿里普惠体)">
                                    <input type="url" id="custom-font-url-input" placeholder="字体的 CSS 链接 (https://...)">
                                    <button id="add-custom-font-btn" class="btn-primary">添加</button>
                                </div>
                                <ul id="custom-font-list"></ul>
                            </div>
                        </div>
                        <div id="panel-display" class="settings-panel">
                            <!-- ... 显示偏好内容 ... -->
                        </div>
                        <div id="panel-data" class="settings-panel">
                            <!-- ... 数据管理内容 ... -->
                        </div>
                    </div>
                </div>
                <div class="modal-actions">
                    <button id="close-settings-btn" class="btn-secondary">关闭</button>
                    <button id="save-settings-btn" class="btn-primary">保存设置</button>
                </div>
            </div>
        </div>

        <div id="clear-data-modal" class="modal-overlay">
            <div class="modal-content">
                <h2>⚠️ 确认清除所有数据</h2>
                <p>此操作将删除所有日记和设置，且<strong>无法恢复</strong>！</p>
                <p>请输入 <code>DELETE</code> 确认：</p>
                <input type="text" id="clear-data-confirm-input" placeholder="输入 DELETE">
                <div class="modal-actions">
                    <button id="cancel-clear-data-btn" class="btn-secondary">取消</button>
                    <button id="confirm-clear-data-btn" class="btn-danger" disabled>确认清除</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 浮动元素 -->
    <div id="toast-container"></div>
    <div id="loading-overlay" class="hidden"><div class="spinner"></div></div>
    <button id="scroll-to-top-btn" class="scroll-to-top-btn" title="回到顶部"><svg viewBox="0 0 24 24"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg></button>
    
    <script src="script.js"></script>
</body>
                                                                                                        </html>
